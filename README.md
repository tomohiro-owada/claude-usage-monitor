# Claude Usage Monitor

macOSメニューバーにClaude.aiの使用状況を表示するElectronアプリです。

## 特徴

- **メニューバー常駐**: `S:11% W:91%` のようにシンプルに表示
  - S: 5時間制限の使用率
  - W: 7日間制限の使用率
- **自動更新**: 1分おきに使用状況を自動更新
- **設定画面**: curlコマンドをペーストするだけで認証情報を更新可能

## スクリーンショット

メニューバー表示例:
```
S:11% W:91%
```

クリックすると詳細情報を表示:
- 5時間制限の使用率とリセット時刻
- 7日間制限の使用率とリセット時刻
- Opus使用率
- 最終更新時刻

## インストール

```bash
npm install
```

## 使い方

### 1. アプリの起動

```bash
npm start
```

### 2. 初回設定

初回起動時、設定画面が自動的に開きます。

#### curlコマンドの取得方法

1. ブラウザで https://claude.ai/settings/usage を開く
2. 開発者ツール（F12またはCmd+Option+I）を開く
3. 「Network」タブを選択
4. ページをリロード
5. `usage` というリクエストを右クリック
6. 「Copy」→「Copy as cURL」を選択
7. 設定画面のテキストボックスに貼り付け
8. 「保存して適用」をクリック

### 3. メニューバー

アプリ起動後、macOSのメニューバーに使用状況が表示されます。

- メニューバーアイコンをクリックすると詳細メニューが表示
- 「今すぐ更新」で手動更新
- 「設定」で認証情報を再設定
- 「終了」でアプリを終了

## ファイル構成

```
.
├── menubar-app.js          # メインアプリケーション
├── claude-api.js           # Claude API通信
├── config-manager.js       # 設定管理
├── curl-parser.js          # curlコマンド解析
├── preload.js              # Electron preloadスクリプト
├── settings.html           # 設定画面UI
├── config.json             # 設定ファイル（自動生成）
├── package.json            # Node.js依存関係
└── README.md               # このファイル
```

## トラブルシューティング

### データが取得できない

1. 設定画面を開く
2. 最新のcurlコマンドを貼り付け
3. 「保存して適用」をクリック

### Cloudflareエラー

認証情報（cookie）の有効期限が切れている可能性があります。
設定画面から最新のcurlコマンドを再設定してください。

### メニューバーに表示されない

アプリが起動しているか確認してください。
ターミナルで `npm start` を実行すると、コンソールにログが表示されます。

## 開発

### デバッグモード

```bash
# コンソールを表示して起動
npm start
```

コンソールにログが出力されます。

### 手動でAPIを呼び出す

```bash
node fetch-claude-usage.js
```

## ライセンス

MIT

## 注意事項

- このアプリはClaude.aiの非公式ツールです
- 認証情報（cookie）はローカルに保存されます（`config.json`）
- cookieは定期的に更新する必要があります
- Claude.aiのAPI仕様変更により動作しなくなる可能性があります
